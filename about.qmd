---
title: "Building Edtech for Mental Wellbeing"
subtitle: "By Na & Avianna"
---


### Question 1: Which age group is most heavily impacted?

```{r, message=F, include = F}
library(tidyverse)
library(ggplot2)
library(readxl)
library(ggpubr)
library(ggmosaic)
library(gridExtra)
library(cowplot)
```

```{r, message = F, warning = F, include = F}
delhi <- read_csv("./data/delhi_data.csv") %>%
  drop_na(`Rating of Online Class experience`) %>%
  filter(`Time spent on Online Class` > 0) %>%
  mutate(age_cat = case_when(
    `Age of Subject` < 18 ~ "Under 18",
    `Age of Subject` >= 18 & `Age of Subject` <= 22 ~ "18-22", 
    `Age of Subject` > 22 ~ '22+'
)) %>%
  mutate(age_cat = fct_relevel(age_cat, c("Under 18", "18-22", "22+"))) %>%
    mutate(time_online = case_when(
    `Time spent on Online Class` < 2 ~ "0-2",
    `Time spent on Online Class` >= 2 & `Time spent on Online Class` < 4 ~ "2-4",
    `Time spent on Online Class` >= 4 & `Time spent on Online Class` < 7 ~ "4-7",
    `Time spent on Online Class` >= 7 ~ 'Over 7'
)) %>%
  mutate(new_rating = case_when(
    `Rating of Online Class experience` == "Excellent" | `Rating of Online Class experience` == "Good" ~ "Positive",
    `Rating of Online Class experience` == "Poor" | `Rating of Online Class experience` == "Very poor" ~ "Negative", 
    `Rating of Online Class experience` == "Average" ~ 'Neutral'
)) %>%
    mutate(social = factor(`Do you find yourself more connected with your family, close friends , relatives  ?`)) %>%
    mutate(health = factor(`Health issue during lockdown`)) 

delhi_college <- delhi %>%
    filter(age_cat == "18-22") 
```

```{r, warning = F, include = F}
colombia <- read_excel("./data/colom.xlsx") %>%
  select(-c("1. During the process of collecting, typing and manipulating the data provided by you. These data will be used only for academic purposes and will be presented in an aggregated way. Given the above, are you willing to participate in this survey?", "2. What is your student code?")) %>%
  mutate(age_cat = case_when(
    `3. How old are you?` < 18 ~ "Under 18",
    `3. How old are you?` >= 18 & `3. How old are you?` <= 22 ~ "18-22", 
    `3. How old are you?` > 22 ~ '22+'
)) %>%
  mutate(age_cat = fct_relevel(age_cat, c("Under 18", "18-22", "22+"))) %>%
  mutate(commu = case_when(
    `13.5 How happy are you with:\r\nYour ability to communicate with others` >= 0 & `13.5 How happy are you with:\r\nYour ability to communicate with others` <=2 ~ "Very dissatisfied",
    `13.5 How happy are you with:\r\nYour ability to communicate with others` >= 3 & `13.5 How happy are you with:\r\nYour ability to communicate with others` <= 4 ~ "Dissatisfied",
    `13.5 How happy are you with:\r\nYour ability to communicate with others` >= 5 & `13.5 How happy are you with:\r\nYour ability to communicate with others` <= 6 ~ "Neutral",
    `13.5 How happy are you with:\r\nYour ability to communicate with others` >= 7 & `13.5 How happy are you with:\r\nYour ability to communicate with others` <= 8 ~ "Satisfied",
    `13.5 How happy are you with:\r\nYour ability to communicate with others` >= 8 ~ "Very Satisfied"
)) %>%
  mutate(commu = fct_relevel(commu, c("Very dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very satisfied"))) %>%
  mutate(onl_class = case_when(
    `11.19 I am comfortable with the online classes.` >= 0 & `11.19 I am comfortable with the online classes.` <=2 ~ "Very low comfortability",
    `11.19 I am comfortable with the online classes.` >= 3 & `11.19 I am comfortable with the online classes.` <= 4 ~ "Low comfortability",
    `11.19 I am comfortable with the online classes.` >= 5 & `11.19 I am comfortable with the online classes.` <= 6 ~ "Neutral",
    `11.19 I am comfortable with the online classes.` >= 7 & `11.19 I am comfortable with the online classes.` <= 8 ~ "High comfortability",
    `11.19 I am comfortable with the online classes.` >= 8 ~ "Very high comfortability"
)) %>%
  mutate(onl_class = fct_relevel(onl_class, c("Very low comfortability", "Low comfortability", "Neutral", "High comfortability", "Very high comfortability"))) 
```

```{r, include = F}
# Read data
jordan_uni_mentalHealth <- read_csv("data/jordan-covid-mentalhealth.csv")

#Online class comfortability and Age Group

age_factored <- factor(c("18-24","25-30", "+30"))

agegroup_plot1 <- jordan_uni_mentalHealth %>% 
  mutate(onlineclass_comfortability = `Taking quizzes and exams online from home was not comfortable and made me nervous.`) %>% 
  mutate(onlineclass_comfortability = case_when(
    onlineclass_comfortability == "Agree" | onlineclass_comfortability == "Strongly Agree" ~ "Yes",
    onlineclass_comfortability == "Disagree" | onlineclass_comfortability == "Disagree" ~ "No",
  )) %>% 
  mutate(Age = factor(Age, age_factored)) %>% 
  filter(!is.na(onlineclass_comfortability)) %>% 
  ggplot(aes(x = Age, fill = onlineclass_comfortability)) +
  geom_bar( position = "fill") +scale_fill_manual(values = c( "steelblue4", "#FF8F05") )

# Social connection and Age group

agegroup_plot4 <- jordan_uni_mentalHealth %>% 
  mutate(onlineclass_connectivity = `The distance learning system, caused by the COVID-19 epidemic, resulted in social distancing.`) %>% 
  mutate(onlineclass_connectivity = case_when(
    onlineclass_connectivity == "Agree" | onlineclass_connectivity == "Strongly Agree" ~ "Yes",
    onlineclass_connectivity == "Disagree" | onlineclass_connectivity == "Disagree" ~ "No",
  )) %>% 
  mutate(Age = factor(Age, age_factored)) %>% 
  filter(!is.na(onlineclass_connectivity)) %>% 
  ggplot(aes(x = Age, fill = onlineclass_connectivity)) +
  geom_bar( position = "fill") +
  scale_fill_manual(values = c( "steelblue4", "#FF8F05")) 

# Time management

agegroup_plot3 <- jordan_uni_mentalHealth %>% 
  mutate(onlineclass_timemanagement = `After COVID-19: I have fixed hours for bedtime and wake-up.`) %>% 
  mutate(onlineclass_timemanagement = case_when(
    onlineclass_timemanagement == "Agree" | onlineclass_timemanagement == "Strongly Agree" ~ "No",
    onlineclass_timemanagement == "Disagree" | onlineclass_timemanagement == "Disagree" ~ "Yes",
  )) %>% 
  mutate(Age = factor(Age, age_factored)) %>% 
  filter(!is.na(onlineclass_timemanagement)) %>% 
  ggplot(aes(x = Age, fill = onlineclass_timemanagement)) +
  geom_bar( position = "fill") +
  scale_fill_manual(values = c( "steelblue4", "#FF8F05")) 

# Health issues

agegroup_plot2 <- jordan_uni_mentalHealth %>% 
  mutate(onlineclass_healthissues = `Measures of lockdown, closures, and quarantine, brought by COVID-19 caused stress, frustration, and depression.`) %>% 
  mutate(onlineclass_healthissues = case_when(
    onlineclass_healthissues == "Agree" | onlineclass_healthissues == "Strongly Agree" ~ "Yes",
    onlineclass_healthissues == "Disagree" | onlineclass_healthissues == "Disagree" ~ "No",
  )) %>% 
  mutate(Age = factor(Age, age_factored)) %>% 
  filter(!is.na(onlineclass_healthissues)) %>% 
  ggplot(aes(x = Age, fill = onlineclass_healthissues)) +
  geom_bar( position = "fill") +
  scale_fill_manual(values = c( "steelblue4", "#FF8F05")) 

```

```{r, include = F}
delhi_palette_1 <- c("#621713", "#efe5e3", "#aabf67")
delhi_palette_2 <- c("#621713", "#aabf67")

theme_customization_a = 
  theme(text = element_text(size = 10, hjust = 0.5, family = "serif"),
        plot.title = element_text(size = 10, hjust = 0.5, face = "bold"))

theme_customization_b = 
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        plot.subtitle = element_text(size = 10, hjust = 0.5, face = "italic"),
        text = element_text(size = 10, hjust = 0.5, family = "serif"))
```

To investigate which age group is most heavily affected by the transition to online learning, we compare the reported comfortability with online class, state of wellness, efficiency with time utilization, and perceived social connection across different age groups.

It is apparent that Delhi college-aged students (aged 18 to 22) report the greatest negative impact with their online learning experience. They reported a negative experience during COVID-19 learning at over double the proportion of the other two age groups, and are also much less likely to have a positive experience with online class. These students also reported more health issues, less efficient time utilization, and worse social connection.

```{r, echo = FALSE}
delhi_age_plot <- function(fill_var, fill_label, plt_title, pal, legend_pos) {
  delhi %>%
    ggplot(aes(x = age_cat, fill = {{fill_var}})) +
    geom_bar(position = "fill") +
    labs(x = 'Age Group', y = 'Proportion', fill = fill_label, title = plt_title) + 
    scale_fill_manual(values = pal) +
    theme_classic() +
    theme(legend.position = legend_pos) +
    theme_customization_a
}

p1 <- delhi_age_plot(new_rating, "Class Rating", "Online Class Rating", delhi_palette_1, "bottom") +
    theme(axis.title.x = element_blank(), axis.text.x = element_blank(),
          axis.line.x = element_blank(), axis.ticks.x = element_blank())

p2 <- delhi_age_plot(`Health issue during lockdown`, "Others", "Health Issue", delhi_palette_2, "bottom") +
    theme(axis.title = element_blank(), axis.text = element_blank(),
          axis.line = element_blank(), axis.ticks = element_blank())

p3 <- delhi_age_plot(`Time utilized`, "", "Time Utilized", delhi_palette_2, "none")

p4 <- delhi_age_plot(`Do you find yourself more connected with your family, close friends , relatives  ?`, "", "Improved Social Connection", delhi_palette_2, "none") +
   theme(axis.title.y = element_blank(), axis.text.y = element_blank(),
         axis.line.y = element_blank(), axis.ticks.y = element_blank())

delhi_age_plot <- ggarrange(p1, p2, p3, p4, nrow = 2, ncol = 2)

annotate_figure(
      annotate_figure(delhi_age_plot, top = text_grob("Green = positive/yes, Red = negative/no, White = neutral", size = 8, face = "italic", family = "serif")),
      top = text_grob("COVID-19 Education Responses by Age Group in Delhi", 
              size = 14, face = "bold", 
              family = "serif"))
```

When it comes to Colombian students, college-aged students remain more negatively impacted by the transition to online learning compared to students of different age groups. In particular, they have a lower median score regarding their comfortability with online class. While the median score for all age groups across the other 3 categories are comparable, college students are more likely to report a lower score for their health satisfaction and social connection, as well as higher stress with time management.

```{r, echo=FALSE}
colombia_age_plot <- function(fill_var, fill_title) {
  colombia %>%
    ggplot(aes(x = age_cat, y = {{fill_var}})) +
    ggdist::stat_halfeye(fill = "#f99fbe", color = NA, alpha = 0.5) +
    geom_boxplot(fill = "#de5d83", width = 0.3) +
    labs(x = 'Age Group', y = 'Score', title = fill_title) + 
    theme_classic() +
    theme_customization_a
}

c1 <- colombia_age_plot(`11.19 I am comfortable with the online classes.`, "Online Class Comfortability") +
   theme(axis.title.x = element_blank(), axis.text.x = element_blank(),
         axis.line.x = element_blank(), axis.ticks.x = element_blank())

c2 <- colombia_age_plot(`13.6 How happy are you with:\r\nYour health overall`, "Health Satisfaction") +
    theme(axis.title.x = element_blank(), axis.text.x = element_blank(),
          axis.line.x = element_blank(), axis.ticks.x = element_blank())

c3 <- colombia_age_plot(`14.5 How stressed are you with:\r\nThe lack of time`, "Time Management Stress")

c4 <- colombia_age_plot(`13.5 How happy are you with:\r\nYour ability to communicate with others`, "Good Social Communication")

colombia_age_plot <- ggarrange(c1, c2, c3, c4, nrow = 2, ncol = 2)

annotate_figure(colombia_age_plot,
      top = text_grob("COVID-19 Education Responses by Age Group in Colombia", 
              size = 14, face = "bold", family = "serif")) 
```

Similarly, the 18-24 year-old age group in the Jordan University dataset ranks the highest in terms of proportion for 4 out of 4 categories. More specifically, around 80-90% of the 18-24 year-old Jordan University students reported with mental health issues and lowered connection with others during COVID-19 while being nervous and uncomfortable with taking quizzes and exams online from home. Furthermore, more than half of the 18-24 year-old population claimed that they did not have fixed bedtime and wake-up hours during COVID-19, as opposed to only 40% of their 25-30 year-old counterparts and 30% of those who are 30+ years old.

```{r, echo = FALSE}
agegroupAnalysis_jordan <- cowplot::plot_grid( 
                  agegroup_plot1 + 
                        theme(axis.text.x = element_text(family = "serif"),
                              axis.text.y = element_text(family = "serif"),
                              axis.title.x = element_blank(),                              axis.title.y = element_text(family = "serif"),
                              legend.position = "none",
                              plot.title = element_text(hjust = 0.5, face = "bold", family = "serif")) +
                        labs(title = "Online Class Discomfort",
                             y = "Proportion"),
                   agegroup_plot2 +
                        theme(axis.text.x = element_text(family = "serif"),
                              axis.text.y = element_text(family = "serif"),
                              axis.ticks.y = element_blank(),
                              axis.title.y = element_blank(),
                              axis.title.x = element_blank(),
                              legend.position = "none",
                              plot.title = element_text(hjust = 0.5,face = "bold", family = "serif"),
                              )+
                        labs(title = "Increased Mental Health Issues"), 
                  agegroup_plot3 + 
                        theme(axis.text.x = element_text(family = "serif"),
                              axis.text.y = element_text(family = "serif"),
                              axis.ticks.y = element_blank(),
                              axis.title.y = element_text(family = "serif"),
                              axis.title.x = element_blank(),
                              legend.position = "none",
                              plot.title = element_text(hjust = 0.5, face = "bold", family = "serif")
           )+
                        labs(title = "Declined Sleep Management",
                              y = "Proportion"),
                   agegroup_plot4 + 
                        theme(axis.text.x = element_text(family = "serif"),
                              axis.text.y = element_text(family = "serif"),
                              axis.ticks.y = element_blank(),
                              axis.title.y = element_blank(),
                              axis.title.x = element_blank(),
                              legend.position = "none",
                              plot.title = element_text(hjust = 0.5, face = "bold", family = "serif"),
                             )+
                          labs(title = "Declined Social Connection"),
                   nrow = 2,
                  rel_heights = c(1.5,1.5)
          
                  )
# extract legend from plot1 
legend <- get_legend( 
  agegroup_plot1 +
  theme_classic() +
    theme(plot.title = element_text(hjust = 0.5, face = "bold", family = "serif")) +
    guides(color = guide_legend(nrow = 1)) + 
    theme(legend.position = "bottom",
          ) +
  labs(fill = "Rating")
) 



# Combine combined plot and legend using plot_grid() 
annotate_figure(plot_grid(agegroupAnalysis_jordan, legend,ncol=1,rel_heights = c(1, .1)), top = text_grob("COVID-19 Education Responses by Age Group in Jordan", 
              size = 14, face = "bold", 
              family = "serif",
              vjust = 0.2, hjust = 0.5))
                  
```

### Question 2: How do digital learning tools affect university students mental well being?

There are 3 key themes relating to mental health and digital learning tools that arise from our datasets: Average time spent on online learning platforms, Level of social connection, and Level of comfortability with online classes. We find this overlap from 3 different universities in 3 different countries worthy of further investigation, even though each theme might not be presented in all 3 datasets. In visualizing the correlation between university student mental health status and these pressure points, we found insights that can inform the current status of digital learning tools.

#### 1. Time Spent on Online Class (no data from Colombia)

Contrary to our hypothesis, there is a negative relationship between the number of hours Delhi college students spent online and reported health issue. Among college students that did report health problems, most spent under 4 hours for online learning.

```{r, message = F, warning = F, echo = FALSE}
delhi_college %>%
  group_by(time_online, `Health issue during lockdown`) %>%
  summarize(n = n()) %>%
  mutate(freq = n/sum(n)) %>%
  ggplot(aes(x=time_online, y=`Health issue during lockdown`, size  = freq)) +
  geom_point(alpha = 0.9, color = "#aabf67") +
  labs(x = "Hours Spent Online", title = "Time Spent on Online Learning vs. Health in Delhi College Students", size = "Frequency") +
  scale_size_continuous(range = c(3, 10)) +
  theme_minimal() +
  theme(panel.grid.major = element_line(color = "grey")) +
  theme_customization_b
```

In responding to how digital learning tools affect their mental wellbeing, Jordan college students overwhelmingly reported with exhaustion the more they spend using digital education platforms on a daily basis. This correlation between exhaustion and average daily digital use only amplifies after COVID-19. In details, before COVID-19, around 42% of all Jordan University students, who spent 1-3 hours daily on digital learning platforms, agreed that they are exhausted due to the use of digital learning tools. After COVID-19, Jordan students spend more time using digital learning tools daily, with 30% of them having a 3-6 average daily use and 26% of them having a 6-9 average daily use, all of whom agreed that they endure exhaustion because of digital learning tools. It is special to note that there were no students who spend more than 12 hours daily on digital learning tools that reported no exhaustion after COVID-19.

```{r, include = F}

hours_factored <- factor(c("1-3","3-6","6-9","9-12","+12"))

# Create a new row
new_row <- data.frame(b4_covid_exhaustion_screens = "Agree", b4covid_techuse = "+12", `Before COVID-19` = 0)

new_row <- new_row %>%  
  mutate(`Before COVID-19` = 0) %>% 
  select(b4_covid_exhaustion_screens, b4covid_techuse, `Before COVID-19`)

beforecovid_data <- jordan_uni_mentalHealth %>%
  mutate(covid_techuse = factor(`Before COVID-19: How much time do you spend using the digital tools in learning?`,hours_factored)) %>% 
  mutate(covid_exhaustion_screens = 
    `Before COVID-19: Continuous exposure to electronic screens in online learning is tiring and exhausting`
    ) %>%  
  mutate(covid_exhaustion_screens = case_when(
    covid_exhaustion_screens == "Agree" | covid_exhaustion_screens == "Strongly Agree" ~ "YES",
    covid_exhaustion_screens == "Disagree" | covid_exhaustion_screens == "Disagree" ~ "NO",
  )) %>% 
  count(covid_exhaustion_screens, covid_techuse) %>% 
  mutate(`Before COVID-19` = n /sum(n))

aftercovid_data<- jordan_uni_mentalHealth %>%
  mutate(covid_techuse = factor(`After COVID-19: How much time do you spend using the digital tools in learning?`,hours_factored)) %>% 
  mutate(covid_exhaustion_screens =
    `After COVID-19: Continuous exposure to electronic screens in online learning is tiring and exhausting`
    ) %>%  
  mutate(covid_exhaustion_screens = case_when(
    covid_exhaustion_screens == "Agree" | covid_exhaustion_screens == "Strongly Agree" ~ "YES",
    covid_exhaustion_screens == "Disagree" | covid_exhaustion_screens == "Disagree" ~ "NO",
  )) %>% 
  count(covid_exhaustion_screens, covid_techuse) %>% 
  mutate(`After COVID-19` = n /sum(n))
  

test3 <- full_join(beforecovid_data, aftercovid_data, by = c("covid_techuse", "covid_exhaustion_screens")) %>%  select(covid_exhaustion_screens, covid_techuse, `Before COVID-19`, `After COVID-19`)

test3<- test3 %>% 
  pivot_longer(cols = 3:4, names_to = "state", values_to = "Frequency") %>%
  mutate(state = factor(state, levels = c("Before COVID-19", "After COVID-19")))


```

```{r, echo= FALSE, warning= FALSE }

test3 %>% 
  filter(!is.na(covid_exhaustion_screens)) %>% 
  ggplot()+
  geom_point(aes(y = factor(covid_exhaustion_screens, c("NO", "YES")), x = covid_techuse, size = Frequency), color ="#FF8F05") +
  facet_grid(.~state)+
  theme_bw()+
  labs( title = "Do Jordan college students agree that digital learning tools cause exhaustion?",
        x = "Average daily digital use (hours)"
  )+
  theme(axis.text.y = element_text(family = "serif"),
        axis.title.y = element_blank(),
        axis.text.x = element_text(family = "serif"),
        axis.title.x = element_text(family = "serif"),
        legend.title = element_text(family = "serif"),
        legend.text = element_text(family = "serif", size = 8.5),
        plot.title = element_text(face = "bold",  hjust = 0.2, family = "serif"))+ 
  scale_size(range = c(0,9) , breaks = seq(0.0, 0.8,by = 0.1)) +
  guides(alpha = FALSE) 

```

#### 2. Social Connection

For Delhi college students, there is a higher percentage of reported health problems among students with worsened social bonds compared to those reporting improved social connection. Interestingly, the majority of Delhi college students reported improvement in their level of social connection. 

```{r, warning = FALSE, echo = FALSE}
delhi_college %>%
   ggplot() +
   geom_mosaic(aes(weight = 1, x = product(social), fill = health), na.rm = TRUE) +
   geom_mosaic_text(aes(x = product(social), fill = health)) +
    labs(title = "Social Connection vs. Health Among Delhi College Students", x = "Improved Social Connection", y = "Health Issue during Lockdown", fill = "Health Issue during Lockdown") +
    scale_fill_manual(values = c("#621713", "#aabf67")) +
    theme_classic() +
    theme(legend.position = "bottom") +
    theme_customization_b
```

Colombian college students who are either satisfied or very satisfied with their social communication demonstrate higher median scores for their health rating compared to students with worsened or experience no changes in their social communication satisfaction level. When we look at the distribution, it is notable that students who are highly satisfied with their social communication are more likely to rate a 10, the highest score, for their health satisfaction rating.

```{r, warning = F, echo = FALSE}
colombia %>%
  ggplot(aes(x = commu, y = `13.6 How happy are you with:\r\nYour health overall`)) +
    ggdist::stat_halfeye(fill = "#f99fbe", color = NA, alpha = 0.5) +
    geom_boxplot(fill = "#de5d83", width = 0.2) +
    labs(x = 'Satisfaction with Social Communication', y = 'Health Satisfaction Rating', title = 'Correlation between Good Social Communication and Well-being in Colombian Students') + 
    theme_classic() +
    theme_customization_b
```

Within the Jordan dataset, 98% of the students report with both mental health issues and increased isolation caused by online class. When investigating the marginal distributions, most Jordan students have mental health issues during COVID-19 as well as most Jordan students report increased isolation due to online class during COVID-19. Additionally, among the combinations of experiences (mental health issues with and without increased isolation, and isolation without mental health issues), the fewest students fall into the category of experiencing mental health issues without increased isolation.

```{r, echo = FALSE, warning = FALSE}
jordan_uni_mentalHealth %>%
  mutate(onlineclass_connectivity = `Prolonged use of digital tools (mobile, laptop, i-pad) causes studentsâ€™ isolation`) %>%
  mutate(onlineclass_healthissues = `Measures of lockdown, closures, and quarantine, brought by COVID-19 caused stress, frustration, and depression.`) %>%
  mutate(onlineclass_connectivity = factor(case_when(
    onlineclass_connectivity == "Agree" | onlineclass_connectivity == "Strongly Agree" ~ "Yes",
    onlineclass_connectivity == "Disagree" | onlineclass_connectivity == "Disagree" ~ "No",
    ), c("No", "Yes"))
  )%>% 
  mutate(onlineclass_healthissues = factor(case_when(
    onlineclass_healthissues == "Agree" | onlineclass_healthissues == "Strongly Agree" ~ "Yes",
    onlineclass_healthissues == "Disagree" | onlineclass_healthissues == "Disagree" ~ "No",
        ), c("No", "Yes")
  ) )%>%
  filter(!is.na(onlineclass_connectivity)) %>%
  filter(!is.na(onlineclass_healthissues)) %>%
  ggplot() +
  geom_mosaic(aes(x = product(onlineclass_healthissues), fill = onlineclass_connectivity))+
  theme_minimal() +
  scale_fill_manual(values = c( "steelblue4","#FF8F05")) +
  labs( x = "Mental Health Issues",
        y = "Increased Isolation",
        fill = "Rating",
        title = "Increased Isolation Due To Online Class versus Mental Health Issues Rating",
        subtitle = "In Jordan University Students") +
  theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5, family = "serif"),
        plot.subtitle =element_text(size = 10, hjust = 0.5, family = "serif"),
        axis.title = element_text(family = "serif"),
        axis.text = element_text( family = "serif"),
        legend.title = element_text(family = "serif"),
        legend.text = element_text(family = "serif")) +
  annotate(geom = "label", x = 0.5, y = 0.5, label = "92.98%")
```


#### 3. Online Class Comfortability

For this question, we create a confusion matrix with each dot representing one case of college student. Regardless of health problems, the majority of Delhi college students report a negative experience with online learning during COVID-19. Among those with reported health issue, the proportion of students with negative online class rating are around 2 times and 5 times higher than that with neutral and positive online learning experience, respectively. 


```{r, warning = FALSE, echo = FALSE}
comfort_filtered <- function(data, comfort_var, mh_var, comfort_var_resp,  mh_var_resp) {
  count <- data %>% 
    filter( {{comfort_var}} == comfort_var_resp) %>% 
    filter( {{mh_var}} == mh_var_resp) %>% 
    nrow()
  
  filtered_data <- data %>% 
    filter({{comfort_var}} == comfort_var_resp) %>% 
    filter({{mh_var}} == mh_var_resp) %>% 
    mutate(x = case_when(
      mh_var_resp == "YES" ~ runif(count, 0.05, 1.85),
      mh_var_resp == "NO" ~ runif(count, 2.05,3.85)
    )) %>% 
    mutate(y = case_when( 
      comfort_var_resp == "Positive" ~ runif(count, 4.05, 5.85),
      comfort_var_resp == "Neutral" ~ runif(count, 2.05, 3.85),
      comfort_var_resp == "Negative" ~  runif(count, 0.05, 1.85)))
  
  return(filtered_data)
}

perc_calc_delhi <- function(df) {
    perc <- as.character(round(nrow(df) * 100 / nrow(delhi_college), 1))
    return (paste(perc, "%"))
}

YesPos <- comfort_filtered (delhi_college, new_rating, health, "Positive", "YES")
YesNeu <- comfort_filtered (delhi_college, new_rating, health, "Neutral", "YES" )
YesNeg <- comfort_filtered (delhi_college, new_rating, health, "Negative", "YES")
NoPos <- comfort_filtered (delhi_college, new_rating, health, "Positive", "NO")
NoNeu <- comfort_filtered (delhi_college, new_rating, health, "Neutral", "NO")
NoNeg <- comfort_filtered (delhi_college, new_rating, health, "Negative", "NO")

ggplot() +
  geom_point(data = YesPos, aes(x=x, y=y), color = "#aef359", alpha = .8, size = 2) +
  geom_point(data = YesNeu, aes(x=x,y=y), color = "#aabf67", alpha = .8,size = 2) +
  geom_point(data = YesNeg, aes(x=x,y=y), color = "#253e23", alpha = .8, size = 2) +
  geom_point(data = NoPos, aes(x=x,y=y), color = "pink", alpha = .8, size = 2) +
  geom_point(data = NoNeu, aes(x=x,y=y), color = "#dc143c", alpha = .8, size = 2) +
  geom_point(data = NoNeg, aes(x=x,y=y), color = "#621713", alpha = .8, size = 2) +
  geom_hline(aes(yintercept = 2), size = .3) +
  geom_hline(aes(yintercept = 4), size = .3) +
  geom_vline(aes(xintercept = 2), size = .3) + 
  labs(title = "Online Class Rating vs. Health Issues in Delhi College Students", 
       subtitle = "One dot = one case", x = "Health Issue", y = "Online Class Rating") +
  annotate("text", x = c(1, 3), y = -0.2, label = c("YES", "NO"), size = 4, family = "serif") +
  annotate("text", x = -0.2, y = c(1,3,5), label = c("Negative", "Neutral", "Positive"), size = 4, family = "serif", angle = 90) +
  annotate("label", x = 1, y = c(1,3,5), label = c(perc_calc_delhi(YesNeg), perc_calc_delhi(YesNeu), perc_calc_delhi(YesPos)), size = 4, family = "serif", fill = "white") +
  annotate("label", x = 3, y = c(1,3,5), label = c(perc_calc_delhi(NoNeg), perc_calc_delhi(NoNeu), perc_calc_delhi(NoPos)), size = 4, family = "serif", fill = "white") +
  theme_classic() +
  theme(axis.text = element_blank(), axis.ticks = element_blank(), 
        axis.line = element_blank()) +
  theme_customization_b
```

With regard to the Colombian student dataset, college students with higher comfortability level with online class also give higher median scores for their rated well-being compared to the other groups. Students who are not comfortable or ambivalent about online class are also more likely to report a low score (0 to 2) for their health satisfaction level. 

```{r, echo = FALSE}
colombia %>%
  ggplot(aes(x = onl_class, y = `13.6 How happy are you with:\r\nYour health overall`)) +
    ggdist::stat_halfeye(fill = "#f99fbe", color = NA, alpha = 0.5) +
    geom_boxplot(fill = "#de5d83", width = 0.2) +
    labs(x = 'Online Class Comfortability', y = 'Health Satisfaction Rating', title = 'Correlation between Online Class Comfortability and Well-being in Colombian Students') + 
    theme_classic() +
    theme_customization_b
```


```{r, warning = FALSE, echo = FALSE}

comfort_mh_filtered <- function(data, comfort_var, mh_var, comfort_var_resp,  mh_var_resp) {
  count <- data %>% 
    filter( {{comfort_var}} == comfort_var_resp ) %>% 
    filter( {{mh_var}} == mh_var_resp) %>% nrow()
  
  filtered_data <- data %>% 
    filter( {{comfort_var}} == comfort_var_resp ) %>% 
    filter( {{mh_var}} == mh_var_resp) %>% 
    mutate(x = case_when(
      mh_var_resp == "Yes" ~ runif(count, 0.05, 1.85),
      mh_var_resp == "No" ~ runif(count, 2.05,3.85)
    )) %>% 
    mutate( y = case_when( 
      comfort_var_resp == "Yes" ~ runif(count, 2.05,3.85),
      comfort_var_resp == "No" ~  runif(count, 0.05, 1.85)))
  
  return(filtered_data)
}

perc_calc_jordan <- function(df) {
    perc <- as.character(round(nrow(df) * 100 / nrow(comfort_mentalhealth), 1))
    return (paste(perc, "%"))
}

comfort_mentalhealth <- jordan_uni_mentalHealth %>%  
  mutate(onelineclass_comfortability = `Taking quizzes and exams online from home was not comfortable and made me nervous.`) %>% 
  mutate(onlineclass_mentalHealthissues = `Measures of lockdown, closures, and quarantine, brought by COVID-19 caused stress, frustration, and depression.`) %>% 
  mutate(onelineclass_comfortability = factor(case_when(
    onelineclass_comfortability == "Agree" | onelineclass_comfortability == "Strongly Agree" ~ "No",
    onelineclass_comfortability == "Disagree" | onelineclass_comfortability == "Strongly Disagree" ~ "Yes"
    ), c("No", "Yes")
    ))%>% 
  mutate(onlineclass_mentalHealthissues = factor(case_when(
    onlineclass_mentalHealthissues == "Agree" | onlineclass_mentalHealthissues == "Strongly Agree" ~ "Yes",
    onlineclass_mentalHealthissues == "Disagree" | onlineclass_mentalHealthissues == "Strongly Disagree" ~ "No"
        ), c("No", "Yes")
  )) %>% 
  select(ID, onlineclass_mentalHealthissues,onelineclass_comfortability) %>% 
  filter(!is.na(onlineclass_mentalHealthissues), !is.na(onelineclass_comfortability)) 

combo_yesYes <- comfort_mh_filtered(comfort_mentalhealth, onelineclass_comfortability, onlineclass_mentalHealthissues, "Yes", "Yes" ) 
combo_noNo <- comfort_mh_filtered(comfort_mentalhealth, onelineclass_comfortability, onlineclass_mentalHealthissues, "No", "No" )
combo_noYes <- comfort_mh_filtered(comfort_mentalhealth, onelineclass_comfortability, onlineclass_mentalHealthissues, "No", "Yes" )
combo_yesNo <- comfort_mh_filtered(comfort_mentalhealth, onelineclass_comfortability, onlineclass_mentalHealthissues, "Yes", "No" )

  
```

In the same vein, 77.1% of Jordan university students experience both discomfort with online class, more specifically online exams and assignments, as well as increased mental health issues during COVID-19. The second most-populated combinations of experiences are students with negative mental health and online class comfortability. The lowest ranking out of all categories are those with no mental health issues and issues with online class at all. This suggests that there is a positive relationship between online class comfortability and mental health.

```{r,  warning = F, echo = FALSE}
ggplot() +
  geom_point(data = combo_yesYes, aes(x=x,y=y), color = "#FF8F05", alpha = .8, size =2) +
  geom_point(data = combo_noNo, aes(x=x,y=y), color = "pink", alpha = .8,size =2) +
  geom_point(data = combo_noYes, aes(x=x,y=y), color = "steelblue1", alpha = .8, size =2) +
  geom_point(data = combo_yesNo, aes(x=x,y=y), color = "steelblue4", alpha = .8,size =2) +
  geom_hline(aes(yintercept=2),linewidth = .3 ) +
  geom_vline(aes(xintercept = 2),linewidth = .3 ) +
  annotate(geom = "label", x = 1, y = 3, label = perc_calc_jordan(combo_yesYes), size = 5, family = "serif", fill = "white") +
  annotate(geom = "label", x = 1, y = 1, label = perc_calc_jordan(combo_noYes), size = 5, family = "serif", fill = "white") +
  annotate(geom = "label", x = 3, y = 1, label = perc_calc_jordan(combo_noNo), size = 5, family = "serif", fill = "white") +
  annotate(geom = "label", x = 3, y = 3, label = perc_calc_jordan(combo_yesNo), size = 5, family = "serif", fill = "white") +
  annotate("text", x = c(1, 3), y = -0.2, label = c("YES", "NO"), size = 4, family = "serif")  +
   annotate("text", y = c(1, 3), x = -0.2, label = c("NO", "YES"), size = 4, family = "serif") +
   labs(title = "Online class comfortability vs Mental Health Issues\nin Jordan University students during COVID-19" ,
       subtitle = "1 dot = 1 case",
       y = "Online class comfortability",
       x = "Increased Mental Health Issues") + 
  theme_minimal() +
  theme(axis.text = element_blank(), axis.ticks = element_blank(), 
        axis.line = element_blank())+
  theme(plot.title = element_text(vjust = 1,hjust = 0.5, face = "bold", size = 15, family = "serif"),
        plot.subtitle = element_text(vjust =1,hjust = 0.5, size = 13, family = "serif", face = "italic"),
        axis.title.x = element_text(family = "serif"),
        axis.title.y = element_text(family = "serif")
        ) 
```

### Question 3: Is there universality across the datasets?


